# Same applies when there is no seconds symbol (e.g. 45°12'7.38).
# Note that one should not use blank spaces in Dg, Min or Sec arguments (will return NA).
# For more details on formats see:
# https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#Coordinate_format_conversion
# Use paste0("[", Dg, Min, Sec, "]") to build regex [] pattern
# therefore, strsplit() will split string "varb" by what symbols you give to Dg, Min, Sec
DMS <- sapply(strsplit(varb, paste0('[', Dg, Min, Sec, ']')), as.numeric)
# DMS is a matrix; first row contains degrees; second – minutes; third – seconds.
# If the format is "degrees decimal minutes" (e.g. 40° 26.767′ N) and not
# "degrees minutes seconds" (e.g. 40° 26′ 46″ N), then the matrix has only two valid rows:
# first row contains degrees; the second – minutes;
# therefore, compute conversion for seconds only if there are more than 2 rows in DMS
# and Sec is different from NA (if there are seconds in the DMS format)
decdg <- abs(DMS[1, ]) + DMS[2, ]/60 + ifelse(dim(DMS)[1] > 2  & !is.na(Sec), DMS[3, ]/3600, 0)
# all cordinates from Southern or Western Hemispheres become negative in their decimal format
SW <- grepl(pattern = SW.Hemisphere, x = varb, ignore.case = TRUE)
return(ifelse(SW, -1, 1) * decdg)
}
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_dec = dg2dec(Lat))-> date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_dec = dg2dec(Lat,Dg="°", Min="'"))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_dec = dg2dec(Lat,Dg="°", Min="'"))-> date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_dec = dg2dec(Lat,Dg="°", Min="'",Sec="''S|N"))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat,from = 'deg_dec_min', to = 'dec_deg'))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat))
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,from = 'deg_dec_min', to = 'dec_deg'))-> date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,from = 'deg_dec_min', to = 'dec_deg'))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_remove(Lat, " ")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,from = 'deg_dec_min', to = 'dec_deg'))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_remove(Lat_fix, " ")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,from = 'deg_dec_min', to = 'dec_deg'))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚"," ")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,from = 'deg_dec_min', to = 'dec_deg'))-> date_updated
date_updated
conv_unit(c("101 44.32","3 19.453"), "deg_dec_min", "deg_min_sec")
conv_unit(c("101 44.32","3 19.453"), "deg_dec_min", "dec_deg")
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚"," "))
conv_unit(c("101 44.32","3 19.453","59 54.292"), "deg_dec_min", "dec_deg")
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚"," ")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg'))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚"," "))
conv_unit(c("101 44.32","3 19.453","59 54.292"), "deg_dec_min", "dec_deg")
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚"," ")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg'))-> date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚"," "))
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg'))-> date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg'))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')),
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' N")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')),
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' N")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg'))-> date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat,Lon) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' N")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg'))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
dplyr::select(Lat,Lon) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg'))-> date_updated
date_updated
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg'))-> date_updated
date_updated
example_final_Data
sample_Data
ctd_Data
ctd_Data
ctd_Data <- read.csv(file = here("dy2012_ctd_data.csv"), header=T)
ctd_Data
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position)
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
filter(., !is.na(Lat)) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position) %>%
left_join(ctd_Data)
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position) %>%
left_join(ctd_Data)
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position) %>%
left_join(ctd_Data) -> DY2012_sample_data
write.csv(DY2012_sample_data, file="DY2012_sample_data_20240621", quote=F)
write.csv(DY2012_sample_data, file="DY2012_sample_data_20240621.csv", quote=F)
DY2012_sample_data
write.csv(DY2012_sample_data, file="DY2012_sample_data_20240621.csv", quote=F, fileEncoding="UTF-8")
write.csv(DY2012_sample_data, file="DY2012_sample_data_20240621.csv", sep=",",quote=F, fileEncoding="UTF-8")
write.table(DY2012_sample_data, file="DY2012_sample_data_20240621.csv", sep=",",quote=F, fileEncoding="UTF-8")
write.table(DY2012_sample_data, file="DY2012_sample_data_20240621.txt", sep="\t",quote=F, fileEncoding="UTF-8")
DY2012_sample_data
write.table(DY2012_sample_data, file="DY2012_sample_data_20240621.txt", sep="\t",quote=F, fileEncoding="UTF-8", row.names = FALSE)
DY2012_sample_data
library(readr)
readr:write_excel_csv(DY2012_sample_data, file="DY2012_sample_data_20240621.csv")
readr::write_excel_csv(DY2012_sample_data, file="DY2012_sample_data_20240621.csv")
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚",""),
Lon_fix = Lon_fix*-1) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position) %>%
left_join(ctd_Data) -> DY2012_sample_data
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., , Lon_dec = Lon_dec*-1)
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_dec=as.numeric(Lon_dec)) %>%
mutate(., , Lon_dec = Lon_dec*-1)
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local = force_tzs(Date_UTC, tzones="US/Alaska") ) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_dec=as.numeric(Lon_dec)) %>%
mutate(., , Lon_dec = Lon_dec*-1) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position) %>%
left_join(ctd_Data) -> DY2012_sample_data
write.table(DY2012_sample_data, file="DY2012_sample_data_20240621.txt", sep="\t",quote=F, fileEncoding="UTF-8", row.names = FALSE)
readr::write_excel_csv(DY2012_sample_data, file="DY2012_sample_data_20240621.csv")
library(tidyverse)
library(here)
library(lubridate)
library(measurements)
library(sp)
library(readr)
ctd_Data <- read.csv(file = here("dy2012_ctd_data.csv"), header=T)
sample_Data <- read.csv(file = here("dy2012_sample_metadata_20240612.csv"), header=T,fileEncoding="UTF-8")
example_final_Data <- read.table(file = here("example_sample_metadata_forR.txt"), header=T,sep="\t")
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
mutate(., Date_local= format(Date_UTC,tz="US/Alaska"))
sample_Data %>%
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
mutate(., Date_local= format(Date_UTC,tz="US/Alaska")) %>%
dplyr::select(Lat)
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
mutate(., Date_local= format(Date_UTC,tz="US/Alaska")) %>%
dplyr::select(Lat) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚",""))
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local= format(Date_UTC,tz="US/Alaska")) %>%
dplyr::select(Lat) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚",""))
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local= format(Date_UTC,tz="US/Alaska")) %>%
dplyr::select(Lat) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg'))
sample_Data
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local= format(Date_UTC,tz="US/Alaska")) %>%
dplyr::select(Lat) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg'))
library(tidyverse)
library(here)
library(lubridate)
library(measurements)
library(sp)
library(readr)
ctd_Data <- read.csv(file = here("dy2012_ctd_data.csv"), header=T)
sample_Data <- read.csv(file = here("dy2012_sample_metadata_20240612.csv"), header=T,fileEncoding="UTF-8")
example_final_Data <- read.table(file = here("example_sample_metadata_forR.txt"), header=T,sep="\t")
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local= format(Date_UTC,tz="US/Alaska")) %>%
dplyr::select(Lat) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_dec=as.numeric(Lon_dec)) %>%
mutate(., , Lon_dec = Lon_dec*-1) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position) %>%
left_join(ctd_Data) -> DY2012_sample_data
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local= format(Date_UTC,tz="US/Alaska")) %>%
dplyr::select(Lat) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_dec=as.numeric(Lon_dec)) %>%
mutate(., , Lon_dec = Lon_dec*-1) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position) %>%
left_join(ctd_Data) -> DY2012_sample_data
library(tidyverse)
library(here)
library(lubridate)
library(measurements)
library(sp)
library(readr)
ctd_Data <- read.csv(file = here("dy2012_ctd_data.csv"), header=T)
sample_Data <- read.csv(file = here("dy2012_sample_metadata_20240612.csv"), header=T,fileEncoding="UTF-8")
example_final_Data <- read.table(file = here("example_sample_metadata_forR.txt"), header=T,sep="\t")
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local= format(Date_UTC,tz="US/Alaska")) %>%
dplyr::select(Lat) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_dec=as.numeric(Lon_dec)) %>%
mutate(., , Lon_dec = Lon_dec*-1) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position) %>%
left_join(ctd_Data) -> DY2012_sample_data
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local= format(Date_UTC,tz="US/Alaska")) %>%
dplyr::select(Lat) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚",""))
sample_Data
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC)) %>%
mutate(.,  Date_UTC = as.POSIXct(Combined_date, format="%m/%d/%y %H:%M", tz="UTC"),
Date_local= format(Date_UTC,tz="US/Alaska")) %>%
mutate(., Lat_fix =str_remove(Lat, "' N")) %>%
mutate(., Lat_fix =str_replace(Lat_fix, "˚","")) %>%
mutate(., Lat_dec = measurements::conv_unit(Lat_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_fix =str_remove(Lon, "' W")) %>%
mutate(., Lon_fix =str_replace(Lon_fix, "˚","")) %>%
mutate(., Lon_dec = measurements::conv_unit(Lon_fix,'deg_dec_min','dec_deg')) %>%
mutate(., Lon_dec=as.numeric(Lon_dec)) %>%
mutate(., , Lon_dec = Lon_dec*-1) %>%
mutate(., cast= str_c("ctd0",Cast_No.),
nb=Rosette_position) %>%
left_join(ctd_Data) -> DY2012_sample_data
DY2012_sample_data
readr::write_excel_csv(DY2012_sample_data, file="DY2012_sample_data_20240621.csv")
sample_Data %>%
mutate(., Combined_date = str_c(Collection_Date_UTC, " ",Collection_Time_UTC))
